id: secrets-in-files

info:
  name: Secrets in files
  author: ayadi momhamed
  severity: high
  tags: keys,file,secret,exposures

file:
  - extensions:
      - all
    extractors:
      - type: regex
        name: secrets
        regex:
          - "(password|pwd|passwd|pass|key|secret|private|access|api)((_|-){0,})(\\s{0,})(key|pass|credentials|auth|cred|creds|secret|password|access|token)(\\s{0,})((=|:|is){0,})"
          - "(user|client)((_|-){0,})(\\s{0,})(key|pass|credentials|auth|cred|creds|secret|password|access|token)(\\s{0,})((=|:|is){0,})"
      - type: regex
        name: aws-secrets
        regex:
          - "(aws|amazon_aws|amazon_mws)((_|-){0,})(\\s{0,})(key|pass|credentials|auth|cred|creds|secret|password|access|token)(\\s{0,})((=|:|is){0,})"
      - type: regex
        name: firebase-database
        regex:
          - "[a-z0-9.-]+\\.firebaseio\\.com"
          - "[a-z0-9.-]+\\.firebaseapp\\.com"            
      - type: regex
        name: s3-bucket
        regex:
          - "[a-z0-9.-]+\\.s3\\.amazonaws\\.com"
          - "[a-z0-9.-]+\\.s3-[a-z0-9-]\\.amazonaws\\.com"
          - "[a-z0-9.-]+\\.s3-website[.-](eu|ap|us|ca|sa|cn)"
          - "//s3\\.amazonaws\\.com/[a-z0-9._-]+"
          - "//s3-[a-z0-9-]+\\.amazonaws\\.com/[a-z0-9._-]+"          
